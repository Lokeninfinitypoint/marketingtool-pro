import"./index.C4Xe0k1A.js";import"./_commonjsHelpers.Cpj98o6Y.js";class r{constructor(t,e){this.items=[],this.options={},this.positions=[],this.initDefaultOptions(),this.extendOptions(e),this.initMenuItems(t),this.getSectionsPositions(),this.bindWindowEvents(),this.bindMenuItems(),this.options.autoSetFirstActive&&this.changeActiveMenuItem(this.items[0])}initDefaultOptions(){this.options={duration:400,activeOffset:40,scrollOffset:10,smoothScroll:!0,autoSetFirstActive:!0,easingFunction:(t,e,i,s)=>(t/=s/2)<1?i/2*t*t*t+e:i/2*((t-=2)*t*t+2)+e,afterActive:void 0,beforeActive:void 0}}extendOptions(t){if(t){for(let e in t)if(t.hasOwnProperty(e)){const i=e,s=t[i];s!==void 0&&(this.options[i]=s)}}}initMenuItems(t){this.items=[],Array.isArray(t)||(t=[t]),t.forEach(e=>{const i=Array.from(document.querySelectorAll(e));this.items=this.items.concat(i)})}getTargetOffset(t){const e=t.getAttribute("href"),i=document.querySelector(e);return e&&!e.match(/^#?$/)?i.offsetTop:0}bindWindowEvents(){window.addEventListener("load",this.onWindowUpdate.bind(this),!1),window.addEventListener("scroll",this.onWindowUpdate.bind(this),!1),window.addEventListener("resize",this.onWindowUpdate.bind(this),!1)}bindMenuItems(){this.items.forEach(t=>{t.addEventListener("click",this.onMenuItemClick.bind(this),!1)})}onWindowUpdate(){this.getSectionsPositions(),this.updateActiveMenuItem()}getSectionsPositions(){this.positions=this.items.map(t=>this.getTargetOffset(t)-this.options.activeOffset)}updateActiveMenuItem(){const t=this.getScrollOffset(),e=this.items.filter((s,o)=>this.positions[o]<=t);if(e.length===0){t<=this.options.activeOffset&&this.changeActiveMenuItem(this.items[0]);return}const i=e[e.length-1];this.changeActiveMenuItem(i)}getScrollOffset(){return document.body.scrollTop||window.scrollY}resetActiveMenuItem(){this.items.forEach(t=>{t.classList.remove("active")})}changeActiveMenuItem(t){t.classList.contains("active")||(this.resetActiveMenuItem(),t.classList.add("active"),typeof this.options.afterActive=="function"&&this.options.afterActive(t))}onMenuItemClick(t){t.preventDefault();const e=t.target,i=this.items.indexOf(e);i!==-1&&typeof this.options.beforeActive=="function"&&this.options.beforeActive(this.items[i]),i!==-1&&(this.updateLocationHash(i),this.animatePageScroll(i))}updateLocationHash(t){const e=this.items[t].getAttribute("href"),i=location.pathname+location.search;e&&!e.match(/^#?$/)&&history.pushState(e,document.title,i+e)}animatePageScroll(t){const e=-this.options.activeOffset+this.options.scrollOffset,i=this.positions[t]-e;this.options.smoothScroll?this.scrollTo(i,this.options.duration):(window.scrollTo(0,i),this.updateActiveMenuItem())}scrollTo(t,e,i=0){if(e<=0)return;const s=t-this.getScrollOffset();i+=10,setTimeout(()=>{const o=this.options.easingFunction(i,this.getScrollOffset(),s,e);window.scroll(0,o),i<e?this.scrollTo(t,e,i):this.updateActiveMenuItem()},10)}}window.ScrollMenu=r;const n=document.querySelector(".scroll-menu > ol");document.addEventListener("DOMContentLoaded",function(){n&&new r(".scroll-menu a",{activeOffset:128,scrollOffset:128,smoothScroll:!1,afterActive:c=>{const t=c.offsetTop+3;n&&n.setAttribute("style",`--active-offset: ${t}px`)}})});
