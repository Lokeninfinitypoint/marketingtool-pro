!function(){"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(e){var o=function(e,o){if("object"!=t(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var s=i.call(e,o||"default");if("object"!=t(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===o?String:Number)(e)}(e,"string");return"symbol"==t(o)?o:o+""}var o=window.ctFrontend;function i(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,i)}return o}function s(t){for(var o=1;o<arguments.length;o++){var s=null!=arguments[o]?arguments[o]:{};o%2?i(Object(s),!0).forEach((function(o){var i,n,a;i=t,n=o,a=s[o],(n=e(n))in i?Object.defineProperty(i,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):i[n]=a})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}const n=function(t,e,o){const i=t.querySelectorAll(".ct-waitlist-users");i.length&&i.forEach((function(t){t.dataset.count=e,t.innerHTML=o}))},a=function(t,e){if(!e||e.blocksy_stock_quantity>0||e.is_in_stock&&!e.backorders_allowed||e.backorders_allowed&&"no"===ct_localizations.blc_ext_waitlist.waitlist_allow_backorders)t.dataset.state="hidden";else{if(e.blocksy_waitlist.subscription_id||ct_localizations.blc_ext_waitlist.list.includes(e.variation_id)){t.dataset.state="subscribed";const o=t.querySelector(".unsubscribe");return o&&(o.dataset.token=e.blocksy_waitlist.unsubscribe_token,o.dataset.id=e.variation_id),void n(t,e.blocksy_waitlist.waitlist_users,e.blocksy_waitlist.waitlist_users_message)}n(t,e.blocksy_waitlist.waitlist_users,e.blocksy_waitlist.waitlist_users_message),t.dataset.state="visible"}},c=function(t,e=!1){const{blc_ext_waitlist:{user_logged_in:o,list:i}}=ct_localizations;if("no"!==o)return;const s=e?i.filter((function(e){return e!==t})):[...i,t];ct_localizations.blc_ext_waitlist.list=s;const n=new Date(Date.now()+31536e6).toGMTString();document.cookie=`blc_products_waitlist=${JSON.stringify(s)}; expires=${n}; path=/`},r=function(t){const e=new FormData;e.append("action","blc_waitlist_unsubscribe"),e.append("token",t.dataset.token);const o=t.closest(".waitlist-product-actions")||t.closest(".ct-product-waitlist");o.dataset.loading="";const i=t.closest(".product");let s="";if(i){var a;s=null===(a=i.className.match(/post-(\d+)/))||void 0===a?void 0:a[1];const t=i.querySelector('[name="variation_id"]');t&&t.value&&(s=t.value)}e.append("product_id",s),fetch(ct_localizations.ajax_url,{method:"POST",body:e}).then((function(t){return t.json()})).then((function({success:e,data:i}){e?(o.dataset.state="",n(o,i.waitlist_users,i.waitlist_users_message),c(t.dataset.id,!0),function(t){const e=t.closest(".ct-woocommerce-waitlist-table-row");if(!e)return;1===document.querySelectorAll(".ct-woocommerce-waitlist-table-row").length?window.location.reload():e.remove()}(t)):alert(i.message)})).finally((function(){o.removeAttribute("data-loading")}))};(0,o.registerDynamicChunk)("blocksy_ext_woo_extra_waitlist",{mount:function(t,e){if(!e)return void function(t){var e;const o=t.closest(".product");let i=null===(e=o.className.match(/post-(\d+)/))||void 0===e?void 0:e[1];const n=o.querySelector('[name="variation_id"]');n&&n.value&&(i=n.value);const c=new FormData;c.append("action","blc_waitlist_sync"),c.append("product_id",i),fetch(ct_localizations.ajax_url,{method:"POST",body:c}).then((function(t){return t.json()})).then((function({success:e,data:o}){o.subscription_id&&e&&a(t.closest(".ct-product-waitlist"),{blocksy_waitlist:s({},o)})}))}(t);const{event:o,eventData:i}=e;"submit"!==o.type?"click"===o.type&&t.classList.contains("unsubscribe")?r(t):"reset_data"!==o.type&&"found_variation"!==o.type||a(t,i):function(t){var e;const o=new FormData(t);o.append("action","blc_subcribe_to_waitlist");const i=t.closest(".ct-product-waitlist");i.dataset.loading="";const s=t.closest(".product");let a=null===(e=s.className.match(/post-(\d+)/))||void 0===e?void 0:e[1];const r=s.querySelector('[name="variation_id"]');r&&r.value&&(a=r.value),o.append("product_id",a),fetch(ct_localizations.ajax_url,{method:"POST",body:o}).then((function(t){return t.json()})).then((function({success:e,data:o}){e?(i.dataset.state="subscribed",n(i,o.waitlist_users,o.waitlist_users_message),c(o.subscription_id),function(t,e){const o=t.closest(".ct-product-waitlist").querySelector(".unsubscribe");o&&(o.dataset.token=e.token,o.dataset.id=e.productId)}(t,{token:o.unsubscribe_token,productId:a})):alert(o.message)})).finally((function(){i.removeAttribute("data-loading")}))}(t)}})}();